Final Version with everything integrated.
